{% extends "base.html" %}

{% block title %}AI Logic | CardioPulse AI{% endblock %}

{% block content %}
<style>
    /* Hero Header for Model */
    .algo-header {
        background: var(--primary-gradient);
        border-radius: 30px;
        padding: 60px 40px;
        color: white;
        margin-bottom: 50px;
        position: relative;
        overflow: hidden;
    }

    .algo-header::after {
        content: '\f1bb'; /* FontAwesome tree icon */
        font-family: 'Font Awesome 6 Free';
        font-weight: 900;
        position: absolute;
        right: -30px;
        bottom: -30px;
        font-size: 15rem;
        opacity: 0.1;
    }

    .info-card {
        background: var(--glass-bg);
        border-radius: 24px;
        border: 1px solid rgba(255, 255, 255, 0.4);
        padding: 35px;
        height: 100%;
        transition: transform 0.3s ease;
    }

    /* Decision Tree Branching Animation */
    .tree-step {
        border-left: 2px solid #ff416c;
        padding-left: 20px;
        margin-bottom: 25px;
        position: relative;
    }
    .tree-step::before {
        content: '';
        position: absolute;
        left: -8px;
        top: 0;
        width: 15px;
        height: 15px;
        background: #ff416c;
        border-radius: 50%;
    }

    /* Importance Bars */
    .importance-container {
        margin-top: 30px;
    }
    .bar-label {
        font-size: 0.85rem;
        font-weight: 700;
        margin-bottom: 5px;
        display: flex;
        justify-content: space-between;
    }
    .bar-bg {
        height: 8px;
        background: #eee;
        border-radius: 10px;
        margin-bottom: 20px;
        overflow: hidden;
    }
    .bar-fill {
        height: 100%;
        background: var(--primary-gradient);
        border-radius: 10px;
        animation: slideRight 1.5s ease-out forwards;
    }

    @keyframes slideRight {
        from { width: 0; }
    }
</style>

<div class="animate__animated animate__fadeIn">
    
    <header class="algo-header shadow-lg text-center text-md-start">
        <div class="row align-items-center">
            <div class="col-md-8">
                <span class="badge bg-white text-danger mb-3 fw-bold">ALGORITHM ARCHITECTURE</span>
                <h1 class="display-4 fw-bold mb-3">The Random Forest Engine</h1>
                <p class="lead opacity-90">Discover the "Wisdom of the Crowd" approach our AI uses to interpret clinical biomarkers.</p>
            </div>
        </div>
    </header>

    <div class="row g-4 mb-5">
        <div class="col-lg-7">
            <div class="info-card">
                <h3 class="fw-bold mb-4 text-danger"><i class="fas fa-network-wired me-2"></i>How it Thinks</h3>
                
                <div class="tree-step">
                    <h5 class="fw-bold">Step 1: Data Sampling</h5>
                    <p class="small text-muted">The model creates 100 unique subsets from the 70,000 patient records using a technique called "Bootstrapping."</p>
                </div>

                <div class="tree-step">
                    <h5 class="fw-bold">Step 2: Tree Construction</h5>
                    <p class="small text-muted">For each subset, a Decision Tree is grown. Each tree asks different questions (e.g., "Is BP > 140?" or "Is Age > 50?").</p>
                </div>

                

                <div class="tree-step">
                    <h5 class="fw-bold">Step 3: Majority Voting</h5>
                    <p class="small text-muted">When you click 'Predict', all 100 trees vote. If 70 trees say 'Risk' and 30 say 'Healthy', the final prediction is 'Risk' with high confidence.</p>
                </div>

                <div class="p-4 bg-light rounded-4 mt-4 border">
                    <h6 class="fw-bold mb-2">Why this works:</h6>
                    <p class="small mb-0 text-muted">Single decision trees are prone to "overfitting" (memorizing data rather than learning it). By averaging 100 trees, our Random Forest smooths out errors and provides a more generalized medical prediction.</p>
                </div>
            </div>
        </div>

        <div class="col-lg-5">
            <div class="info-card">
                <h3 class="fw-bold mb-2 text-danger"><i class="fas fa-chart-bar me-2"></i>Feature Weight</h3>
                <p class="small text-muted mb-4">Relative importance of features in determining cardiovascular risk.</p>

                <div class="importance-container">
                    <div class="bar-label"><span>Systolic BP (ap_hi)</span> <span class="text-danger">38%</span></div>
                    <div class="bar-bg"><div class="bar-fill" style="width: 38%;"></div></div>

                    <div class="bar-label"><span>Weight (BMI Indicator)</span> <span class="text-primary">18%</span></div>
                    <div class="bar-bg"><div class="bar-fill" style="width: 18%;"></div></div>

                    <div class="bar-label"><span>Age</span> <span class="text-primary">15%</span></div>
                    <div class="bar-bg"><div class="bar-fill" style="width: 15%;"></div></div>

                    <div class="bar-label"><span>Cholesterol</span> <span class="text-primary">12%</span></div>
                    <div class="bar-bg"><div class="bar-fill" style="width: 12%;"></div></div>

                    <div class="bar-label"><span>Glucose</span> <span class="text-muted">9%</span></div>
                    <div class="bar-bg"><div class="bar-fill" style="width: 9%; opacity: 0.5;"></div></div>

                    <div class="bar-label"><span>Lifestyle (Smoke/Active)</span> <span class="text-muted">8%</span></div>
                    <div class="bar-bg"><div class="bar-fill" style="width: 8%; opacity: 0.5;"></div></div>
                </div>

                

                <div class="alert alert-danger border-0 rounded-4 py-3 mt-4">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-exclamation-circle fa-2x me-3 opacity-50"></i>
                        <p class="small mb-0 fw-bold">Note: High Systolic BP is the strongest outlier in our model, followed closely by Age-Weight correlation.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row mb-5">
        <div class="col-12">
            <div class="info-card text-center">
                <h4 class="fw-bold mb-4">Why we chose Random Forest</h4>
                <div class="table-responsive">
                    <table class="table table-hover align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>Algorithm</th>
                                <th>Accuracy</th>
                                <th>Stability</th>
                                <th>Verdict</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Logistic Regression</td>
                                <td>71%</td>
                                <td>High</td>
                                <td class="text-muted">Too Simple</td>
                            </tr>
                            <tr>
                                <td>Decision Tree (Single)</td>
                                <td>68%</td>
                                <td>Low</td>
                                <td class="text-muted">Unstable</td>
                            </tr>
                            <tr class="table-danger">
                                <td class="fw-bold">Random Forest</td>
                                <td class="fw-bold">73.9%</td>
                                <td class="fw-bold text-success">Excellent</td>
                                <td class="fw-bold text-danger">Selected</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="text-center py-4">
        <a href="/predict" class="btn btn-predict btn-lg shadow px-5">Test the Forest Now</a>
    </div>
</div>
{% endblock %}